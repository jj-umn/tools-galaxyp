<tool id="encyclopedia" name="EncyclopeDIA" version="@VERSION@.0">
    <description>Mass Spec DIA data analysis</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        @CMD_IMPORTS@
        @LINK_SCAN_INPUT@
        @LINK_FASTA_INPUT@
        @LINK_LIB_INPUT@
        EncyclopeDIA -Djava.awt.headless=true
        @SCAN_INPUT@
        @FASTA_INPUT@
        @LIB_INPUT@
        @COMMON_OPTIONS@
        @MASS_LIBRARY_TOLERANCE@
        @PERCOLATOR_OPTIONS@
        @PEAK_OPTIONS@
        @WINDOW_OPTIONS@
        @MODIFICATION_OPTIONS@
        -o gxpedia
    ]]></command>
    <inputs>
        <expand macro="scan_input"/>
        <expand macro="fasta_input"/>
        <expand macro="lib_input"/>
        <expand macro="common_options"/>
        <expand macro="mass_library_tolerance"/>
        <expand macro="percolator_options"/>
        <expand macro="peak_options"/>
        <expand macro="window_options"/>
        <expand macro="modification_options"/>
        <param name="select_outputs" type="select" label="Select outputs" multiple="true">
            <option value="log" selected="true">log</option>
            <option value="elib" selected="true">elib</option>
            <option value="first_delta_rt_pdf" selected="true">encyclopedia.txt.first.delta_rt.pdf</option>
            <option value="first_rt_fit_pdf" selected="true">encyclopedia.txt.first.rt_fit.pdf</option>
            <option value="first_rt_fit_txt" selected="true">encyclopedia.txt.first.rt_fit.txt</option>
            <option value="final_delta_rt_pdf" selected="true">encyclopedia.txt.final.delta_rt.pdf</option>
            <option value="final_rt_fit_pdf" selected="true">encyclopedia.txt.final.rt_fit.pdf</option>
            <option value="final_rt_fit_txt" selected="true">encyclopedia.txt.final.rt_fit.txt</option>
            <option value="features" selected="true">features.txt</option>
            <option value="encyclopedia" selected="true">encyclopedia.txt</option>
            <option value="encyclopedia_decoy" selected="true">encyclopedia.decoy.txt</option>
        </param>
    </inputs>
    <outputs>
        <data name="log" format="txt" label="${tool.name} ${on_string} log" from_work_dir="gxpedia.log">
            <filter>'log' in select_outputs</filter>
        </data>
        <data name="elib" format="elib" label="${tool.name} ${on_string} elib" from_work_dir="gxpedia.elib">
            <filter>'elib' in select_outputs</filter>
        </data>
        <data name="first_delta_rt_pdf" format="pdf" label="${tool.name} ${on_string} encyclopedia.txt.first.delta_rt.pdf" from_work_dir="gxpedia.encyclopedia.txt.first.delta_rt.pdf">
            <filter>'first_delta_rt_pdf' in select_outputs</filter>
        </data>
        <data name="first_rt_fit_pdf" format="pdf" label="${tool.name} ${on_string} encyclopedia.txt.first.rt_fit.pdf" from_work_dir="gxpedia.encyclopedia.txt.first.rt_fit.pdf">
            <filter>'first_rt_fit_pdf' in select_outputs</filter>
        </data>
        <data name="first_rt_fit_txt" format="tabular" label="${tool.name} ${on_string} encyclopedia.txt.first.rt_fit.txt" from_work_dir="gxpedia.encyclopedia.txt.first.rt_fit.txt">
            <filter>'first_rt_fit_txt' in select_outputs</filter>
            <actions>
                <action name="column_names" type="metadata" default="library,actual,warpToActual,delta,fitProb,isDecoy,sequence" />
            </actions>
        </data>
        <data name="final_delta_rt_pdf" format="pdf" label="${tool.name} ${on_string} encyclopedia.txt.final.delta_rt.pdf" from_work_dir="gxpedia.encyclopedia.txt.final.delta_rt.pdf">
            <filter>'final_delta_rt_pdf' in select_outputs</filter>
        </data>
        <data name="final_rt_fit_pdf" format="pdf" label="${tool.name} ${on_string} encyclopedia.txt.final.rt_fit.pdf" from_work_dir="gxpedia.encyclopedia.txt.final.rt_fit.pdf">
            <filter>'final_rt_fit_pdf' in select_outputs</filter>
        </data>
        <data name="final_rt_fit_txt" format="tabular" label="${tool.name} ${on_string} encyclopedia.txt.final.rt_fit.txt" from_work_dir="gxpedia.encyclopedia.txt.final.rt_fit.txt">
            <filter>'final_rt_fit_txt' in select_outputs</filter>
            <actions>
                <action name="column_names" type="metadata" default="library,actual,warpToActual,delta,fitProb,isDecoy,sequence" />
            </actions>
        </data>
        <data name="features" format="tabular" label="${tool.name} ${on_string} features.txt" from_work_dir="gxpedia.features.txt">
            <filter>'features' in select_outputs</filter>
            <actions>
                <action name="column_names" type="metadata" default="id,TD,ScanNr,topN,deltaCN,primary,xCorrLib,xCorrModel,LogDotProduct,logWeightedDotProduct,sumOfSquaredErrors,weightedSumOfSquaredErrors,numberOfMatchingPeaks,numberOfMatchingPeaksAboveThreshold,averageAbsFragmentDeltaMass,averageFragmentDeltaMasses,isotopeDotProduct,averageAbsParentDeltaMass,averageParentDeltaMass,eValue,deltaRT,pepLength,charge2,charge3,precursorMz,RTinMin,sequence,protein" />
            </actions>
        </data>
        <data name="encyclopedia" format="tabular" label="${tool.name} ${on_string} encyclopedia.txt" from_work_dir="gxpedia.encyclopedia.txt">
            <filter>'encyclopedia' in select_outputs</filter>
            <actions>
                <action name="column_names" type="metadata" default="PSMId,score,q-value,posterior_error_prob,peptide,proteinIds" />
            </actions>
        </data>
        <data name="encyclopedia_decoy" format="tabular" label="${tool.name} ${on_string} encyclopedia.decoy.txt" from_work_dir="gxpedia.encyclopedia.decoy.txt">
            <filter>'encyclopedia_decoy' in select_outputs</filter>
            <actions>
                <action name="column_names" type="metadata" default="PSMId,score,q-value,posterior_error_prob,peptide,proteinIds" />
            </actions>
        </data>
    </outputs>
    <help><![CDATA[
EncyclopeDIA is a library search engine for DIA data.
You should prefix your arguments with a high memory setting, e.g. "-Xmx8g" for 8gb

Required Parameters:
	-i	input .DIA or .MZML file
	-f	protein .FASTA database
	-l	library .ELIB file

Other Parameters:
	-o	output report file (default: [input file].encyclopedia.txt)
	-acquisition                          (default: Non-Overlapping DIA)
	-enzyme                               (default: trypsin)
	-expectedPeakWidth                    (default: 25)
	-filterPeaklists                      (default: false)
	-fixed                                (default: C=57.0214635)
	-foffset                              (default: 0)
	-frag                                 (default: CID)
	-ftol                                 (default: 10)
	-ftolunits                            (default: ppm)
	-lftol                                (default: 10)
	-lftolunits                           (default: ppm)
	-localizationModification             (default: none)
	-minIntensity                         (default: -1.0)
	-minNumOfQuantitativePeaks            (default: 3)
	-minQuantitativeIonNumber             (default: 3)
	-numberOfExtraDecoyLibrariesSearched  (default: 0.0)
	-numberOfQuantitativePeaks            (default: 5)
	-percolatorProteinThreshold           (default: 0.01)
	-percolatorThreshold                  (default: 0.01)
	-percolatorVersionNumber              (default: 3)
	-poffset                              (default: 0)
	-precursorIsolationMargin             (default: 0)
	-precursorWindowSize                  (default: -1)
	-ptol                                 (default: 10)
	-ptolunits                            (default: ppm)
	-rtWindowInMin                        (default: -1.0)
	-scoringBreadthType                   (default: window)
	-verifyModificationIons               (default: true)

    ]]></help>
    <expand macro="citations" />
</tool>
